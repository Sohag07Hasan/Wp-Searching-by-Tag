=== TDO Tag Fixes ===
Contributors: the_dead_one
Tags: tag, tags, fixes, tag cloud, intersection, category, archive
Donate link: http://tinyurl.com/2mo6up
Requires at least: 2.3
Tested up to: 2.5.1
Stable Tag: 0.5

Some fixes and extensions for Wordpress tags such as a tag cloud using only tags found in a specific category and also tag and category intersection.

== Description ==

This plugin is simply intended as an example of how to implement tag and category intersections. However it has got a bit more feature-heavy recently. Please feel free to re-use the code in your plugin. [This plugin is based on information found here.]( http://boren.nu/archives/2007/10/01/taxonomy-intersections-and-unions/ ) 

**Version 0.5 enables true 'or' tag intersection when using a category. It wasn't working prior to this (and no-one noticed). Thanks to Joel Giddey for spotting it.**

Wordpress 2.3 introduced native tagging support, which is rather nifty. 

But did you know that you can display multiple tags in the one archive and even generate a feed for that?

* "`http://your-blog-uri/?tag=tag1,tag2`" this would get all the posts tagged with tag1 **or** tag2.
* "`http://your-blog-uri/?tag=tag1+tag2`" this would get all the posts tagged with tag1 **and** tag2
* "`http://your-blog-uri/?tag=tag1,tag2&feed=rss`" this would get you an RSS feed for all the posts tagged with tag1 or tag2

Neat huh? But did you notice that on the generated tag page you see only one tag listed in the header? This function fixes that and displays all tags used to generate that tag archive. It does this by silently modifying the `single_tag_title` template tag. It'll even work on the RSS feed generated by that page!

What would be also be cool is to be able to intersect categories and tags so you could grab posts with tags from a specific category for example?

With this plugin you can. It's not perfect however. It only allows intersection between a single category and one or more tags. Technically Wordpress should be able to support multiple categories and tags intersections but it didn't work for me in Wordpress 2.3.x and 2.5. 

So go to one of your category pages. If your using using fancy permalinks then at the end of the url add "`?tdo_tag=a_tag`". If your not using permalinks then you can just use "`&tdo_tag=a_tag`". You must use the tag slug, not the full tag name. You can use multiple tags as above using "," and "+".

* Example not using fancy permalinks: "`http://your-blog-uri/?cat=35&tdo_tag=tag1,tag2`" this would get all posts in category with id 35 and tagged with either tag1 or tag2.
* Example using fancy permalinks: "`http://your-blog-uri/category/mycategory/?tdo_tag=tag1+tag2`" this would get all posts in the category "mycategory" and tagged with both tag1 and tag2.

This plugin uses this intersection code to automatically modify the built-in tag cloud template tag `wp_tag_cloud` so that if it is used on a category archive, it shows only the tags within that category. You can then click on a tag in that tag cloud and it will get the posts for in that category that tagged with that tag. (You can disable this and just use the specific template as you need). 

== Installation ==

Download the zip and extract the files to a subdirectory, called tdo-tag-fixes, of your plugin directory. i.e. `/path_to_wordpress/wp-content/plugins/tdo-tag-fixes`. 

Once you've got it installed, active the plugin via the usual Wordpress plugin menu. 

= Configuring =

To configure the plugin, you must open up tdotf.php in your favourite text editor and look for these lines:

`
// You can change this if you want. Do not set it to 'tag'. If you want to
// disable this feature, just comment it out.
//
$tdotf_tag_get_var = 'tdo_tag';

// If you have fancy permalinks turned on, you can use this option to use a 
// more fancy form of the tdo_tag. The first paramater is the category_slug
// and the second parameter is the tag_slug. If you want to disable this feature
// just comment it out. (It depends on $tdotf_tag_get_var)
//
$tdotf_fancy_tag_regex = 'tdo_cat/(.+)/tdo_tag/(.+)';

// Set to false if you do not wish tag archive titles to be correctly updated
//
$tdotf_fix_tag_title_auto = true;

// Set to false if you do not wish the built-in tag cloud automatically fixed
//
$tdotf_fix_tag_cloud_auto = true;

// Set to false if you do not wish the category archive title to include tag filter
//
$tdotf_fix_cat_title_auto = true;
`

= New Template Tags =

`tdotf_cat_tag_cloud` works exactly like [`wp_tag_cloud`]( http://codex.wordpress.org/Template_Tags/wp_tag_cloud ) and takes all the same arguments except if called on a category archive/template it will display only the tags in that category. It has one additional argument, "cat" can be used to indicate a specific category. If this is not specified it will take the category id of the category template it is in. By default this plugin will automatically change `wp_tag_cloud` so that if it's called on a category archive, it'll use `tdotf_cat_tag_cloud`.

`tdotf_tag_title` and `tdotf_get_tag_title` can be used in place of [`single_tag_title`](http://codex.wordpress.org/Template_Tags/single_tag_title ). It can handle the usage of multiple tags in the URL. By default this plugin will automatically change `single_tag_title` so that if it's use in a tag archive that uses multiple tags, it'll use `tdotf_tag_title` (or `tdotf_get_tag_title`).

`tdotf_the_tags` can be used in place of [`the_tags`](http://codex.wordpress.org/Template_Tags/the_tags) and if used in a category archive, the tag links will point to the category archive filtered by the tag.

== Some more tag tricks ==

If you want to sort results on page generated by using the `tdo_tag` you can just append `orderby` and `order` to the URL. For example:

"`http://your-blog-uri/?cat=35&tdo_tag=tag1,tag2&orderby=title&order=asc`"

Thanks to Tobias Ross who figured this out. You could of course stick this in the fancy permalink if you're okay with doing a little hacking.

== Version History ==

= v0.5: 4th July 2008 =

* Fixed a potential problem with global variables
* The "or" tag functionality for tags with a category didn't work. Fixed.

= v0.4: 8th April 2008 =

* The tag cloud had a "small" bug, it only gathered the tags from the posts on the first page of the category, not all the posts on the category! Doh. Thanks to Tobias Ross for helping me to get to the bottom of it.

= v0.3: 7th April 2008 =

* Small bug fixed. Setting `$tdotf_fix_tag_cloud_auto` to false did not deactivate the automatic tag cloud modification.
* Tag cloud now properly supports exclude, include and number arguments 
* New template tag: tdotf_the_tags
* A basic permalink redirection (as requested)

= v0.2: 20th December 2007 =

* Added a tag cloud based on the built-in tag cloud that shows tags from a single category. 

= v0.1: 6th December 2007 = 

* First release
